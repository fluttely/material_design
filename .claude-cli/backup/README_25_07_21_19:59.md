# Material Design 3 Only

[![pub version](https://img.shields.io/pub/v/material_design.svg)](https://pub.dev/packages/material_design)
[![license](https://img.shields.io/badge/license-BSD-blue.svg)](/LICENSE)

A **comprehensive and enhanced** toolkit for implementing Material Design 3 in Flutter. Build beautiful, accessible, and responsive UIs aligned with official metrics and guidelines using a powerful set of design tokens, accessibility utilities, adaptive patterns, and ready-to-use helper widgets.

This package provides a **complete implementation** of [Material 3](https://m3.material.io/) guidelines with enhanced features including accessibility support, adaptive design patterns, comprehensive theme integration, and advanced animation utilities.

## Installation

Add this line to your project's `pubspec.yaml` file:

```yaml
dependencies:
  material_design: ^0.6.0
```

Then run `flutter pub get`.

## Table of Contents

- [Installation](#installation)
- [Quick Start](#-quick-start)
- [🏗️ Foundations](#️-foundations)
  - [Token Architecture](#-token-architecture)
  - [Spacing & Layout](#spacing--layout) 
  - [Breakpoints & Density](#breakpoints--density)
  - [Motion System](#motion-system)
- [🎨 Styles](#-styles)
  - [Color System](#color-system)
  - [Typography](#typography)
  - [Elevation & Shadows](#elevation--shadows)
  - [Shape System](#shape-system)
- [🔧 Utilities](#-utilities)
  - [Color Utils](#m3colorutils)
  - [Shape Utils](#m3shapeutils)
  - [Motion Utils](#m3motionutils)
  - [Accessibility Utils](#-complete-accessibility-system)
  - [Adaptive Utils](#-advanced-adaptive-design)
- [🎨 Theme Integration](#-professional-theme-integration)
  - [Complete ThemeData Setup](#complete-themedata-setup)
  - [Component Theme Customization](#component-theme-customization)
  - [Dynamic Theming](#dynamic-theming)
- [📱 Components](#-components)
  - [Buttons](#enhanced-button-variations)
  - [Cards](#enhanced-card-variations)
  - [Forms](#building-a-professional-form)
  - [Layouts](#responsive-dashboard-layout)
- [🚀 Performance](#-performance-considerations)
- [🔧 Migration Guide](#-migration-guide)
- [Examples](#-more-examples)

## 🚀 Quick Start

Import the package to start using the tokens:

```dart
import 'package:material_design/material_design.dart';
```

### Basic Setup

```dart
void main() {
  runApp(MyApp());
}

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      title: 'Material Design 3 App',
      theme: M3Theme.light(seedColor: Colors.blue).toThemeData(),
      darkTheme: M3Theme.dark(seedColor: Colors.blue).toThemeData(),
      home: const HomeScreen(),
    );
  }
}
```

---

# 🏗️ Foundations

## 📋 Token Architecture

This library provides a complete implementation following Material Design 3's official token hierarchy:

### 🏗️ Token Hierarchy

#### Reference Tokens (Ref)

Foundation tokens that define the basic design decisions:

- **Color Palettes**: 13-tone color palettes for all color families
- **Typography**: Base typeface definitions and font families
- **Motion**: Fundamental duration and easing curve values
- **Opacity**: Base opacity levels for interaction states

#### System Tokens (Sys)

Semantic tokens that map reference tokens to design intentions:

- **Color Roles**: Primary, secondary, tertiary, error, surface colors
- **Typography Scale**: 15 semantic text styles from display to label
- **Elevation System**: Tonal surface colors and shadow specifications
- **Motion Patterns**: Contextual animation specifications

#### Component Tokens (Comp)

Specific tokens for individual UI components:

- **Button Tokens**: Heights, paddings, radiuses, elevation states
- **Card Tokens**: Elevation levels, shape specifications
- **Dialog Tokens**: Sizing, spacing, and layout specifications
- **Navigation Tokens**: Sizes, spacing for different navigation types

### 🎯 Using the New Token Structure

#### Reference Tokens

```dart
// Access color palettes
final primaryColor = M3RefPalette.getColor(M3RefPalette.primary, 40);
final surfaceColor = M3RefPalette.getColor(M3RefPalette.neutral, 99);

// Typography foundations
final fontFamily = M3RefTypeface.brand; // 'Roboto'
final fontWeight = M3RefTypeface.labelWeight; // 500

// Base motion values
final shortDuration = M3RefDuration.short1; // 250ms
final standardCurve = M3MotionEasing.standard;
```

#### System Tokens

```dart
// Semantic color roles
Container(
  color: M3SysColor.primaryContainer,
  child: Text(
    'System color',
    style: TextStyle(color: M3SysColor.onPrimaryContainer),
  ),
)

// Dark theme colors
final darkScheme = M3SysColorDark.toColorScheme();
```

#### Component Tokens

```dart
// Button specifications
ElevatedButton(
  style: ElevatedButton.styleFrom(
    minimumSize: Size.fromHeight(M3CompButton.heightMedium),
    padding: M3CompButton.paddingMedium,
    shape: RoundedRectangleBorder(
      borderRadius: M3CompButton.shapeMedium,
    ),
  ),
  onPressed: () {},
  child: const Text('Styled Button'),
)
```

## Spacing & Layout

A granular scale for consistent spacing, margins, and layouts following the 4dp grid system.

### M3Spacing

Provides spacing values from `none` to `space128` based on a 4dp grid. Ideal for padding and small gaps between UI elements.

**Example:**

```dart
Padding(
  padding: const EdgeInsets.all(M3Spacing.space16), // 16dp padding
  child: Text('Hello, Material!'),
)
```

### M3Margin

Provides semantic margin values for the outer edges of the screen layout.

- screen (16dp) for compact.
- screenLarge (24dp) for medium/expanded/large/extra-large screens.

**Example:**

```dart
Container(
  margin: const EdgeInsets.symmetric(horizontal: M3Margin.mediumScreen),
  child: Text('Content with screen margins'),
)
```

### M3Spacer

- pane (24dp) for the gap between two content panes.
- screen (16dp) for compact/medium screens.
- screenLarge (24dp) for large/extra-large screens.

**Example:**

```dart
Row(
  children: [
    Expanded(child: ContentPane1()),
    const SizedBox(width: M3Spacer.pane),
    Expanded(child: ContentPane2()),
  ],
)
```

## Breakpoints & Density

### M3Breakpoint

Breakpoints for responsive layouts following M3's window size classes:

- `compact` (0), `medium` (600), `expanded` (840), `large` (1200), `extraLarge` (1600)

**Example:**

```dart
final screenWidth = MediaQuery.of(context).size.width;
if (screenWidth >= M3Breakpoint.medium) {
  // Use a two-column layout
}
```

### M3Density

Adjust component density for different interaction models:

- **`M3Density`**: An enum with `comfortable` (default) and `compact` values.

**Example:**

```dart
// Use a switch to toggle between density settings
final density = isCompact ? M3Density.compact : M3Density.comfortable;

// This could be used to adjust layout constraints
final horizontalPadding = density == M3Density.compact
    ? M3Spacing.space8
    : M3Spacing.space16;
```

## Motion System

Standardized duration and easing curves for animations following M3's motion principles.

### M3MotionDuration

Provides duration values from `short1` to `extralong4`:

**Example:**

```dart
AnimatedContainer(
  duration: M3MotionDuration.long2,
  curve: M3MotionEasing.emphasizedAccelerate,
  // ...
)
```

### M3MotionEasing

Provides easing curves from `emphasizedAccelerate` to `standardDecelerate`:

- `emphasizedDecelerate` - For entering elements
- `emphasizedAccelerate` - For exiting elements  
- `standard` - For simple transitions
- `standardDecelerate` - For persistent elements
- `standardAccelerate` - For temporary elements

---

# 🎨 Styles

## Color System

Complete M3 color system with semantic roles and tonal variations.

### Color Roles & Palettes

- **`M3SysColor`** / **`M3SysColorDark`**: Complete light/dark color role system
- **`M3RefPalette`**: Foundation 13-tone color palettes for Primary, Secondary, Tertiary, Error, Neutral, and NeutralVariant
- **`M3TonalColor`**: Surface colors that adapt based on elevation

**Basic Usage:**

```dart
Container(
  color: M3SysColor.primaryContainer,
  child: Text(
    'Primary container text',
    style: TextStyle(color: M3SysColor.onPrimaryContainer),
  ),
)

// Tonal surface with elevation
Container(
  color: M3TonalColor.fromElevation(context, M3Elevation.level2),
  child: const Text('Elevated surface'),
)
```

## Typography

Complete M3 typography scale with 15 semantic text styles.

### M3TypeScale

Provides the full type scale from `displayLarge` to `labelSmall`:

- **Display**: displayLarge, displayMedium, displaySmall
- **Headline**: headlineLarge, headlineMedium, headlineSmall  
- **Title**: titleLarge, titleMedium, titleSmall
- **Body**: bodyLarge, bodyMedium, bodySmall
- **Label**: labelLarge, labelMedium, labelSmall

**Basic Usage:**

```dart
Text(
  'Display Text',
  style: M3TypeScale.displayLarge,
)

Text(
  'Body Text', 
  style: M3TypeScale.bodyMedium,
)
```

### Enhanced Typography Features

Advanced typography utilities for accessibility and responsiveness:

```dart
// Responsive text that adapts to screen size
Text(
  'Responsive Title',
  style: M3TypeScale.responsiveDisplay(context),
)

// Enhanced readability for accessibility
Text(
  'Accessible Text',
  style: M3TypeScale.enhancedReadability(M3TypeScale.bodyLarge),
)

// High contrast text
Text(
  'High Contrast Text',
  style: M3TypeScale.highContrast(M3TypeScale.bodyMedium),
)
```

## Elevation & Shadows

M3's elevation system with tonal surfaces and contextual shadows.

### M3Elevation & M3Shadow

- **`M3Elevation`**: 6 elevation levels from `level0` (0dp) to `level5` (12dp)
- **`M3Shadow`**: Corresponding shadow specifications for each level

**Example:**

```dart
Card(
  elevation: M3Elevation.level2,
  shadowColor: Colors.transparent, // Use tonal elevation instead
  color: M3TonalColor.fromElevation(context, M3Elevation.level2),
  child: content,
)

// Custom container with elevation
Container(
  decoration: BoxDecoration(
    color: M3TonalColor.fromElevation(context, M3Elevation.level3),
    boxShadow: M3Shadow.fromElevation(M3Elevation.level3),
    borderRadius: M3Shape.large.borderRadius,
  ),
  child: content,
)
```

## Shape System

Complete shape system with radius tokens and shape families.

### M3Radius & M3Shape

- **`M3Radius`**: Values from `none` (0dp) to `extraLarge` (28dp) and `full`
- **`M3Shape`**: Pre-built `ShapeBorder` objects for each radius level

**Example:**

```dart
Container(
  decoration: ShapeDecoration(
    shape: M3Shape.large, // 16dp corner radius
    color: Colors.blue,
  ),
)

// Custom shape with specific radius
Container(
  decoration: BoxDecoration(
    borderRadius: BorderRadius.circular(M3Radius.medium), // 12dp
    color: Colors.red,
  ),
)
```

---

# 🔧 Utilities

## M3ColorUtils

Comprehensive color manipulation and validation utilities:

```dart
// Validate WCAG contrast compliance
final hasAAContrast = M3ColorUtils.meetsWCAGAA(
  foregroundColor: Colors.black,
  backgroundColor: Colors.white,
);

final hasAAAContrast = M3ColorUtils.meetsWCAGAAA(
  foregroundColor: textColor,
  backgroundColor: surfaceColor,
);

// Automatic contrast adjustment
final adjustedColor = M3ColorUtils.adjustForContrast(
  foregroundColor: Colors.grey.shade600,
  backgroundColor: Colors.white,
  targetRatio: 4.5, // WCAG AA
);

// Color mixing and blending
final blendedColor = M3ColorUtils.blend(
  color1: Colors.blue,
  color2: Colors.red,
  ratio: 0.3,
);

// Get appropriate text color for any background
final textColor = M3ColorUtils.getTextColorForBackground(backgroundColor);
```

### M3ShapeUtils

Advanced shape manipulation and responsive utilities:

```dart
// Responsive shape based on screen size
final responsiveShape = M3ShapeUtils.responsiveShape(
  context: context,
  compact: M3Shape.small,
  medium: M3Shape.medium,
  expanded: M3Shape.large,
);

// Brand-specific shape variants
final brandShape = M3ShapeUtils.brandShape(
  baseShape: M3Shape.medium,
  brandMultiplier: 1.5,
);

// Asymmetric shape creation
final asymmetricShape = M3ShapeUtils.asymmetric(
  topLeft: M3Radius.large,
  topRight: M3Radius.small,
  bottomLeft: M3Radius.small,
  bottomRight: M3Radius.large,
);

// Shape family generation
final shapeFamily = M3ShapeUtils.generateFamily(
  baseRadius: 12.0,
  steps: [0.5, 1.0, 1.5, 2.0],
);
```

### M3MotionUtils

Context-aware animation utilities:

```dart
// Component-specific animation duration
final duration = M3MotionUtils.durationForComponent(
  'dialog',
  'enter',
);

// Distance-based animation duration
final distanceDuration = M3MotionUtils.durationForDistance(
  distance: 200.0,
  velocity: 'medium',
);

// Contextual easing curve
final curve = M3MotionUtils.curveForContext('navigation');

// Pre-built animation patterns
Widget fadeInWidget = M3MotionUtils.fadeIn(
  duration: M3MotionDuration.medium2,
  curve: M3MotionEasing.emphasizedDecelerate,
  child: myWidget,
);

Widget slideUpWidget = M3MotionUtils.slideUp(
  distance: 30.0,
  duration: M3MotionDuration.short4,
  child: myWidget,
);

Widget scaleInWidget = M3MotionUtils.scaleIn(
  fromScale: 0.8,
  child: myWidget,
);

// Combined animations
Widget combinedAnimation = M3MotionUtils.slideAndFade(
  slideOffset: const Offset(0, 30),
  fadeOpacity: AnimationController(vsync: this),
  child: myWidget,
);
```

## ♿ Complete Accessibility System

### M3Accessibility Configuration

```dart
// Global accessibility configuration
M3AccessibilityConfig.configure(
  enforceMinimumTouchTargets: true,
  enableHighContrast: false,
  enableReducedMotion: false,
  enableDyslexiaSupport: true,
  contrastStandard: WCAGStandard.AA,
);

// Get current accessibility preferences
final config = M3AccessibilityConfig.current;
final hasHighContrast = config.isHighContrastEnabled;
final prefersReducedMotion = config.prefersReducedMotion;
```

### Accessible Widget Utilities

```dart
// Accessible button with minimum touch target
Widget accessibleButton = M3Accessibility.accessibleButton(
  onPressed: () => handleSubmit(),
  semanticLabel: 'Submit form',
  tooltip: 'Submits the registration form',
  minTouchTarget: Size(44, 44),
  child: const Text('Submit'),
);

// Accessible text field with error handling
Widget accessibleTextField = M3Accessibility.accessibleTextField(
  label: 'Email Address',
  hint: 'Enter your email address',
  helperText: 'We will never share your email',
  errorText: hasError ? 'Please enter a valid email' : null,
  required: true,
  keyboardType: TextInputType.emailAddress,
  onChanged: (value) => validateEmail(value),
);

// Accessible checkbox with proper semantics
Widget accessibleCheckbox = M3Accessibility.accessibleCheckbox(
  value: agreedToTerms,
  onChanged: (bool? value) => setState(() => agreedToTerms = value ?? false),
  label: 'I agree to the Terms of Service',
  semanticLabel: 'Agreement to Terms of Service checkbox',
);
```

### Contrast and Readability

```dart
// Enhanced readability for dyslexia support
TextStyle enhancedStyle = M3TypeScale.enhancedReadability(
  M3TypeScale.bodyLarge,
  enableDyslexiaSupport: true,
);

// High contrast text style
TextStyle highContrastStyle = M3TypeScale.highContrast(
  M3TypeScale.bodyMedium,
  contrastLevel: ContrastLevel.enhanced,
);

// Validate and adjust contrast
Color adjustedTextColor = M3Accessibility.ensureContrast(
  foregroundColor: Colors.grey.shade600,
  backgroundColor: surfaceColor,
  targetRatio: 4.5,
);
```

## 📱 Advanced Adaptive Design

### M3AdaptiveScaffold

Complete responsive scaffold with automatic navigation adaptation:

```dart
class AdaptiveApp extends StatefulWidget {
  @override
  _AdaptiveAppState createState() => _AdaptiveAppState();
}

class _AdaptiveAppState extends State<AdaptiveApp> {
  int selectedIndex = 0;
  
  final destinations = const [
    NavigationDestination(
      icon: Icon(Icons.home_outlined),
      selectedIcon: Icon(Icons.home),
      label: 'Home',
    ),
    NavigationDestination(
      icon: Icon(Icons.search_outlined),
      selectedIcon: Icon(Icons.search),
      label: 'Search',
    ),
    NavigationDestination(
      icon: Icon(Icons.favorite_outline),
      selectedIcon: Icon(Icons.favorite),
      label: 'Favorites',
    ),
    NavigationDestination(
      icon: Icon(Icons.person_outline),
      selectedIcon: Icon(Icons.person),
      label: 'Profile',
    ),
  ];

  @override
  Widget build(BuildContext context) {
    return M3AdaptiveScaffold(
      destinations: destinations,
      selectedIndex: selectedIndex,
      onDestinationSelected: (index) {
        setState(() => selectedIndex = index);
      },
      // Automatically switches between:
      // - NavigationBar (compact)
      // - NavigationRail (medium/expanded) 
      // - NavigationDrawer (large/extra-large)
      body: IndexedStack(
        index: selectedIndex,
        children: const [
          HomeScreen(),
          SearchScreen(),
          FavoritesScreen(),
          ProfileScreen(),
        ],
      ),
      // Optional extended configuration
      enableNavigationRail: true,
      enableNavigationDrawer: true,
      railExtended: false,
      drawerHeader: const UserAccountsDrawerHeader(
        accountName: Text('John Doe'),
        accountEmail: Text('john.doe@example.com'),
      ),
    );
  }
}
```

### Responsive Layout Patterns

```dart
// Responsive value based on window size class
final columns = M3Adaptive.responsiveValue<int>(
  context: context,
  compact: 1,      // Mobile phones
  medium: 2,       // Small tablets, large phones
  expanded: 3,     // Tablets, small desktops
  large: 4,        // Large desktops
  extraLarge: 5,   // Very large screens
);

// Responsive layout with different widgets
Widget responsiveLayout = M3Adaptive.responsiveLayout(
  context: context,
  compact: CompactMobileLayout(),
  medium: TabletLayout(),
  expanded: DesktopLayout(),
  large: LargeDesktopLayout(),
);

// Responsive padding
EdgeInsets adaptivePadding = M3Adaptive.adaptivePadding(
  context: context,
  compact: const EdgeInsets.all(16),
  medium: const EdgeInsets.all(24),
  expanded: const EdgeInsets.all(32),
);
```

### Adaptive Dialogs and Sheets

```dart
// Dialog that adapts to screen size
void showAdaptiveDialog() {
  M3Adaptive.showAdaptiveDialog(
    context: context,
    title: 'Settings',
    content: const SettingsForm(),
    actions: [
      TextButton(
        onPressed: () => Navigator.pop(context),
        child: const Text('Cancel'),
      ),
      FilledButton(
        onPressed: () => saveSettings(),
        child: const Text('Save'),
      ),
    ],
    // Automatically chooses:
    // - Modal dialog on desktop
    // - Fullscreen dialog on mobile
  );
}

// Adaptive sheet
void showAdaptiveSheet() {
  M3Adaptive.showAdaptiveSheet(
    context: context,
    title: 'Filter Options',
    child: const FilterOptionsWidget(),
    // Automatically chooses:
    // - Bottom sheet on mobile
    // - Side sheet on desktop
  );
}
```

### Input Method Adaptation

```dart
// Adapt UI based on input method
Widget adaptiveButton = M3Adaptive.inputMethodAware(
  context: context,
  touch: ElevatedButton(
    style: ElevatedButton.styleFrom(
      minimumSize: const Size(0, 48), // Larger for touch
      padding: const EdgeInsets.symmetric(horizontal: 24),
    ),
    onPressed: onPressed,
    child: const Text('Touch Button'),
  ),
  mouse: ElevatedButton(
    style: ElevatedButton.styleFrom(
      minimumSize: const Size(0, 36), // Smaller for mouse
      padding: const EdgeInsets.symmetric(horizontal: 16),
    ),
    onPressed: onPressed,
    child: const Text('Mouse Button'),
  ),
);

// Check current input method
final inputMethod = M3Adaptive.getInputMethodType(context);
final isTouchPrimary = inputMethod == InputMethodType.touch;
```

---

# 🎨 Professional Theme Integration

## Complete ThemeData Setup

Professional approach to integrating M3 tokens into your app's ThemeData instead of using them statically throughout your code.

### Basic Theme Setup

```dart
class AppTheme {
  static ThemeData lightTheme() {
    final colorScheme = M3SysColor.toColorScheme();
    
    return ThemeData(
      useMaterial3: true,
      colorScheme: colorScheme,
      
      // Typography using M3 tokens
      textTheme: TextTheme(
        displayLarge: M3TypeScale.displayLarge,
        displayMedium: M3TypeScale.displayMedium,
        displaySmall: M3TypeScale.displaySmall,
        headlineLarge: M3TypeScale.headlineLarge,
        headlineMedium: M3TypeScale.headlineMedium,
        headlineSmall: M3TypeScale.headlineSmall,
        titleLarge: M3TypeScale.titleLarge,
        titleMedium: M3TypeScale.titleMedium,
        titleSmall: M3TypeScale.titleSmall,
        bodyLarge: M3TypeScale.bodyLarge,
        bodyMedium: M3TypeScale.bodyMedium,
        bodySmall: M3TypeScale.bodySmall,
        labelLarge: M3TypeScale.labelLarge,
        labelMedium: M3TypeScale.labelMedium,
        labelSmall: M3TypeScale.labelSmall,
      ),
      
      // Card theme using M3 tokens
      cardTheme: CardTheme(
        elevation: M3Elevation.level1,
        shape: M3Shape.medium,
        clipBehavior: Clip.antiAlias,
      ),
      
      // Button themes using M3 component tokens
      elevatedButtonTheme: ElevatedButtonThemeData(
        style: ElevatedButton.styleFrom(
          minimumSize: Size.fromHeight(M3CompButton.heightMedium),
          padding: M3CompButton.paddingMedium,
          shape: RoundedRectangleBorder(
            borderRadius: M3CompButton.shapeMedium,
          ),
          elevation: M3CompButton.elevationDefault,
        ),
      ),
      
      filledButtonTheme: FilledButtonThemeData(
        style: FilledButton.styleFrom(
          minimumSize: Size.fromHeight(M3CompButton.heightMedium),
          padding: M3CompButton.paddingMedium,
          shape: RoundedRectangleBorder(
            borderRadius: M3CompButton.shapeMedium,
          ),
        ),
      ),
      
      outlinedButtonTheme: OutlinedButtonThemeData(
        style: OutlinedButton.styleFrom(
          minimumSize: Size.fromHeight(M3CompButton.heightMedium),
          padding: M3CompButton.paddingMedium,
          shape: RoundedRectangleBorder(
            borderRadius: M3CompButton.shapeMedium,
          ),
          side: BorderSide(width: M3Border.thin),
        ),
      ),
      
      textButtonTheme: TextButtonThemeData(
        style: TextButton.styleFrom(
          minimumSize: Size.fromHeight(M3CompButton.heightMedium),
          padding: M3CompButton.paddingMedium,
          shape: RoundedRectangleBorder(
            borderRadius: M3CompButton.shapeMedium,
          ),
        ),
      ),
      
      // Input decoration theme
      inputDecorationTheme: InputDecorationTheme(
        filled: true,
        fillColor: colorScheme.surfaceVariant.withOpacity(0.4),
        border: OutlineInputBorder(
          borderRadius: M3Shape.small.borderRadius,
          borderSide: BorderSide(width: M3Border.thin),
        ),
        enabledBorder: OutlineInputBorder(
          borderRadius: M3Shape.small.borderRadius,
          borderSide: BorderSide(
            color: colorScheme.outline,
            width: M3Border.thin,
          ),
        ),
        focusedBorder: OutlineInputBorder(
          borderRadius: M3Shape.small.borderRadius,
          borderSide: BorderSide(
            color: colorScheme.primary,
            width: M3Border.thin * 2,
          ),
        ),
        contentPadding: const EdgeInsets.all(M3Spacing.space16),
      ),
      
      // AppBar theme
      appBarTheme: AppBarTheme(
        elevation: 0,
        surfaceTintColor: Colors.transparent,
        backgroundColor: colorScheme.surface,
        foregroundColor: colorScheme.onSurface,
        titleTextStyle: M3TypeScale.titleLarge.copyWith(
          color: colorScheme.onSurface,
        ),
      ),
    );
  }
  
  static ThemeData darkTheme() {
    final colorScheme = M3SysColorDark.toColorScheme();
    
    return lightTheme().copyWith(
      colorScheme: colorScheme,
      // Override specific properties for dark theme if needed
      appBarTheme: AppBarTheme(
        elevation: 0,
        surfaceTintColor: Colors.transparent,
        backgroundColor: colorScheme.surface,
        foregroundColor: colorScheme.onSurface,
        titleTextStyle: M3TypeScale.titleLarge.copyWith(
          color: colorScheme.onSurface,
        ),
      ),
    );
  }
}
```

### Professional MaterialApp Setup

```dart
class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      title: 'Professional M3 App',
      theme: AppTheme.lightTheme(),
      darkTheme: AppTheme.darkTheme(),
      themeMode: ThemeMode.system,
      home: const HomeScreen(),
    );
  }
}
```

## Component Theme Customization

### Advanced Button Customization

Instead of styling buttons individually throughout your app, define them in the theme:

```dart
class AppTheme {
  static ThemeData _buildTheme(ColorScheme colorScheme) {
    return ThemeData(
      useMaterial3: true,
      colorScheme: colorScheme,
      
      // Custom button variants using M3 tokens
      extensions: [
        _CustomButtonTheme(
          primaryButtonStyle: FilledButton.styleFrom(
            minimumSize: Size.fromHeight(M3CompButton.heightLarge),
            padding: M3CompButton.paddingLarge,
            shape: RoundedRectangleBorder(
              borderRadius: M3CompButton.shapeLarge,
            ),
            textStyle: M3TypeScale.labelLarge,
          ),
          
          secondaryButtonStyle: OutlinedButton.styleFrom(
            minimumSize: Size.fromHeight(M3CompButton.heightMedium),
            padding: M3CompButton.paddingMedium,
            shape: RoundedRectangleBorder(
              borderRadius: M3CompButton.shapeMedium,
            ),
            side: BorderSide(
              width: M3Border.thin,
              color: colorScheme.outline,
            ),
            textStyle: M3TypeScale.labelMedium,
          ),
          
          dangerButtonStyle: FilledButton.styleFrom(
            minimumSize: Size.fromHeight(M3CompButton.heightMedium),
            backgroundColor: colorScheme.error,
            foregroundColor: colorScheme.onError,
            shape: RoundedRectangleBorder(
              borderRadius: M3CompButton.shapeMedium,
            ),
          ),
        ),
      ],
    );
  }
}

// Custom theme extension
class _CustomButtonTheme extends ThemeExtension<_CustomButtonTheme> {
  final ButtonStyle primaryButtonStyle;
  final ButtonStyle secondaryButtonStyle;
  final ButtonStyle dangerButtonStyle;

  const _CustomButtonTheme({
    required this.primaryButtonStyle,
    required this.secondaryButtonStyle,
    required this.dangerButtonStyle,
  });

  @override
  ThemeExtension<_CustomButtonTheme> copyWith({
    ButtonStyle? primaryButtonStyle,
    ButtonStyle? secondaryButtonStyle,
    ButtonStyle? dangerButtonStyle,
  }) {
    return _CustomButtonTheme(
      primaryButtonStyle: primaryButtonStyle ?? this.primaryButtonStyle,
      secondaryButtonStyle: secondaryButtonStyle ?? this.secondaryButtonStyle,
      dangerButtonStyle: dangerButtonStyle ?? this.dangerButtonStyle,
    );
  }

  @override
  ThemeExtension<_CustomButtonTheme> lerp(
    covariant ThemeExtension<_CustomButtonTheme>? other,
    double t,
  ) {
    if (other is! _CustomButtonTheme) return this;
    return _CustomButtonTheme(
      primaryButtonStyle: ButtonStyle.lerp(primaryButtonStyle, other.primaryButtonStyle, t)!,
      secondaryButtonStyle: ButtonStyle.lerp(secondaryButtonStyle, other.secondaryButtonStyle, t)!,
      dangerButtonStyle: ButtonStyle.lerp(dangerButtonStyle, other.dangerButtonStyle, t)!,
    );
  }
}

// Usage in components
class CustomButton extends StatelessWidget {
  final VoidCallback? onPressed;
  final Widget child;
  final CustomButtonVariant variant;

  const CustomButton({
    Key? key,
    required this.onPressed,
    required this.child,
    this.variant = CustomButtonVariant.primary,
  }) : super(key: key);

  @override
  Widget build(BuildContext context) {
    final customTheme = Theme.of(context).extension<_CustomButtonTheme>()!;
    
    return switch (variant) {
      CustomButtonVariant.primary => FilledButton(
          onPressed: onPressed,
          style: customTheme.primaryButtonStyle,
          child: child,
        ),
      CustomButtonVariant.secondary => OutlinedButton(
          onPressed: onPressed,
          style: customTheme.secondaryButtonStyle,
          child: child,
        ),
      CustomButtonVariant.danger => FilledButton(
          onPressed: onPressed,
          style: customTheme.dangerButtonStyle,
          child: child,
        ),
    };
  }
}

enum CustomButtonVariant { primary, secondary, danger }
```

## Dynamic Theming

### Responsive Theme Adaptation

```dart
class ResponsiveTheme {
  static ThemeData getTheme(BuildContext context, {required bool isDark}) {
    final windowSize = MediaQuery.of(context).size.width;
    final colorScheme = isDark 
        ? M3SysColorDark.toColorScheme()
        : M3SysColor.toColorScheme();
    
    // Adapt button sizes based on screen size
    final buttonHeight = windowSize >= M3Breakpoint.medium
        ? M3CompButton.heightLarge
        : M3CompButton.heightMedium;
    
    final buttonPadding = windowSize >= M3Breakpoint.medium
        ? M3CompButton.paddingLarge
        : M3CompButton.paddingMedium;
    
    return ThemeData(
      useMaterial3: true,
      colorScheme: colorScheme,
      textTheme: _getResponsiveTextTheme(windowSize),
      
      elevatedButtonTheme: ElevatedButtonThemeData(
        style: ElevatedButton.styleFrom(
          minimumSize: Size.fromHeight(buttonHeight),
          padding: buttonPadding,
          shape: RoundedRectangleBorder(
            borderRadius: M3CompButton.shapeMedium,
          ),
        ),
      ),
      
      // Adaptive card theme
      cardTheme: CardTheme(
        elevation: M3Elevation.level1,
        shape: M3Shape.medium,
        margin: EdgeInsets.all(
          windowSize >= M3Breakpoint.medium
              ? M3Spacing.space16
              : M3Spacing.space12,
        ),
      ),
    );
  }
  
  static TextTheme _getResponsiveTextTheme(double screenWidth) {
    final isLarge = screenWidth >= M3Breakpoint.large;
    
    return TextTheme(
      displayLarge: isLarge 
          ? M3TypeScale.displayLarge
          : M3TypeScale.displayMedium,
      headlineLarge: isLarge
          ? M3TypeScale.headlineLarge
          : M3TypeScale.headlineMedium,
      // ... continue for all text styles
    );
  }
}
```

### Theme-Aware Components

Now your components can use theme values instead of hardcoded tokens:

```dart
// ❌ Avoid - Static token usage
class BadCard extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return Container(
      padding: const EdgeInsets.all(M3Spacing.space16),
      decoration: BoxDecoration(
        color: M3SysColor.surfaceVariant,
        borderRadius: M3Shape.medium.borderRadius,
        boxShadow: M3Shadow.fromElevation(M3Elevation.level1),
      ),
      child: Text(
        'Card content',
        style: M3TypeScale.bodyMedium,
      ),
    );
  }
}

// ✅ Better - Theme-aware implementation
class GoodCard extends StatelessWidget {
  final Widget child;
  
  const GoodCard({Key? key, required this.child}) : super(key: key);
  
  @override
  Widget build(BuildContext context) {
    return Card(
      // Uses theme values set up with M3 tokens
      child: Padding(
        padding: const EdgeInsets.all(16), // Or use theme.cardTheme.margin
        child: child,
      ),
    );
  }
}

// Usage - automatically gets correct styling from theme
Widget build(BuildContext context) {
  return GoodCard(
    child: Text(
      'This text uses theme typography',
      style: Theme.of(context).textTheme.bodyMedium, // From M3TypeScale
    ),
  );
}
```

---

# 📱 Components

Examples of building professional components that leverage your theme integration:

## Professional Form Components

### Theme-Integrated Form

```dart
class ThemedForm extends StatefulWidget {
  @override
  _ThemedFormState createState() => _ThemedFormState();
}

class _ThemedFormState extends State<ThemedForm> {
  final _formKey = GlobalKey<FormState>();
  final _nameController = TextEditingController();
  final _emailController = TextEditingController();
  bool _acceptTerms = false;

  @override
  Widget build(BuildContext context) {
    // All styling comes from theme configuration
    return Form(
      key: _formKey,
      child: Column(
        crossAxisAlignment: CrossAxisAlignment.stretch,
        children: [
          Text(
            'Registration Form',
            style: Theme.of(context).textTheme.headlineMedium,
            textAlign: TextAlign.center,
          ),
          
          SizedBox(height: 24), // Use theme spacing if available
          
          // Theme-styled text field
          TextFormField(
            controller: _nameController,
            decoration: const InputDecoration(
              labelText: 'Full Name',
              hintText: 'Enter your full name',
            ),
            validator: (value) {
              if (value?.isEmpty ?? true) {
                return 'Please enter your name';
              }
              return null;
            },
          ),
          
          const SizedBox(height: 16),
          
          TextFormField(
            controller: _emailController,
            decoration: const InputDecoration(
              labelText: 'Email Address',
              hintText: 'Enter your email address',
              helperText: 'We will never share your email',
            ),
            keyboardType: TextInputType.emailAddress,
            validator: (value) {
              if (value?.isEmpty ?? true) {
                return 'Please enter your email';
              }
              if (!value!.contains('@')) {
                return 'Please enter a valid email address';
              }
              return null;
            },
          ),
          
          const SizedBox(height: 16),
          
          CheckboxListTile(
            value: _acceptTerms,
            onChanged: (value) {
              setState(() => _acceptTerms = value ?? false);
            },
            title: const Text('I agree to the Terms of Service'),
            controlAffinity: ListTileControlAffinity.leading,
          ),
          
          const SizedBox(height: 24),
          
          // Theme-styled button
          ElevatedButton(
            onPressed: _acceptTerms ? _handleSubmit : null,
            child: const Text('Submit'),
          ),
        ],
      ),
    );
  }

  void _handleSubmit() {
    if (_formKey.currentState!.validate()) {
      // Handle form submission
      ScaffoldMessenger.of(context).showSnackBar(
        const SnackBar(content: Text('Registration successful!')),
      );
    }
  }

  @override
  void dispose() {
    _nameController.dispose();
    _emailController.dispose();
    super.dispose();
  }
}
```

## Responsive Card Components

```dart
class ResponsiveCard extends StatelessWidget {
  final String title;
  final String content;
  final VoidCallback? onTap;
  final Widget? leading;

  const ResponsiveCard({
    Key? key,
    required this.title,
    required this.content,
    this.onTap,
    this.leading,
  }) : super(key: key);

  @override
  Widget build(BuildContext context) {
    // Card styling comes from theme
    return Card(
      child: InkWell(
        onTap: onTap,
        borderRadius: Theme.of(context).cardTheme.shape?.borderRadius,
        child: Padding(
          padding: const EdgeInsets.all(16),
          child: Column(
            crossAxisAlignment: CrossAxisAlignment.start,
            children: [
              if (leading != null) ...[
                leading!,
                const SizedBox(height: 12),
              ],
              Text(
                title,
                style: Theme.of(context).textTheme.titleLarge,
              ),
              const SizedBox(height: 8),
              Text(
                content,
                style: Theme.of(context).textTheme.bodyMedium,
              ),
            ],
          ),
        ),
      ),
    );
  }
}
```

## Adaptive Navigation Component

```dart
class AppScaffold extends StatelessWidget {
  final Widget body;
  final String title;
  final int selectedIndex;
  final ValueChanged<int> onDestinationSelected;
  final List<NavigationDestination> destinations;

  const AppScaffold({
    Key? key,
    required this.body,
    required this.title,
    required this.selectedIndex,
    required this.onDestinationSelected,
    required this.destinations,
  }) : super(key: key);

  @override
  Widget build(BuildContext context) {
    return M3AdaptiveScaffold(
      destinations: destinations,
      selectedIndex: selectedIndex,
      onDestinationSelected: onDestinationSelected,
      body: Scaffold(
        appBar: AppBar(
          title: Text(title),
          // AppBar styling comes from theme
        ),
        body: body,
      ),
    );
  }
}
```

---

# 🚀 Performance Considerations

## Optimizing Theme Performance

```dart
class OptimizedThemeProvider extends StatelessWidget {
  final Widget child;

  const OptimizedThemeProvider({Key? key, required this.child}) : super(key: key);

  @override
  Widget build(BuildContext context) {
    return LayoutBuilder(
      builder: (context, constraints) {
        // Only rebuild theme when constraints change significantly
        return _ThemeCache.getTheme(
          constraints: constraints,
          brightness: Theme.of(context).brightness,
          child: child,
        );
      },
    );
  }
}

class _ThemeCache {
  static final Map<String, ThemeData> _cache = {};
  
  static Widget getTheme({
    required BoxConstraints constraints,
    required Brightness brightness,
    required Widget child,
  }) {
    final key = '${constraints.maxWidth}_${brightness.name}';
    
    if (!_cache.containsKey(key)) {
      _cache[key] = ResponsiveTheme.getTheme(
        // Create context-independent theme
        constraints.maxWidth,
        isDark: brightness == Brightness.dark,
      );
    }
    
    return Theme(
      data: _cache[key]!,
      child: child,
    );
  }
  
  static void clearCache() => _cache.clear();
}
```

---

# 🔧 Migration Guide

## From Material 2 to Material Design 3

### Step 1: Update Dependencies

```yaml
# pubspec.yaml
dependencies:
  material_design: ^0.6.0
  flutter:
    sdk: flutter
```

### Step 2: Replace Theme Configuration

```dart
// Before (Material 2)
MaterialApp(
  theme: ThemeData(
    primarySwatch: Colors.blue,
    accentColor: Colors.blueAccent,
    brightness: Brightness.light,
  ),
)

// After (Material 3 with this library)
MaterialApp(
  theme: AppTheme.lightTheme(), // Using M3 tokens
  darkTheme: AppTheme.darkTheme(),
)
```

### Step 3: Update Component Usage

```dart
// Before - Manual styling
Container(
  padding: const EdgeInsets.all(16),
  decoration: BoxDecoration(
    color: Colors.white,
    borderRadius: BorderRadius.circular(8),
    boxShadow: [
      BoxShadow(
        color: Colors.black.withOpacity(0.1),
        blurRadius: 4,
        offset: const Offset(0, 2),
      ),
    ],
  ),
  child: Text('Content'),
)

// After - Theme-integrated
Card(
  child: Padding(
    padding: const EdgeInsets.all(16),
    child: Text(
      'Content',
      style: Theme.of(context).textTheme.bodyMedium,
    ),
  ),
)
```

---

# 🎉 More Examples

## Implementation Status

### ✅ Fully Implemented Features

- **Typography**: Complete M3 type scale with enhanced utilities
- **Color System**: Full role system with utilities and Material You support  
- **Elevation**: Contextual levels with interpolated shadows and animations
- **Motion**: Complete duration and easing system with contextual utilities
- **Shapes**: Full scale with families and responsive utilities
- **Spacing**: 4dp grid system with contextual margins and utilities
- **Breakpoints**: M3 window classes with responsive utilities
- **Borders & Shadows**: Complete system with contextual utilities
- **Opacity**: Interaction states with utilities
- **Integrated Theme**: Complete M3Theme with ThemeData conversion
- **Accessibility**: WCAG utilities with automatic configuration
- **Adaptive Design**: Responsive layouts with automatic navigation
- **Professional Integration**: Theme-based component styling

## Getting Started Checklist

1. ✅ **Install the package** and import Material Design 3
2. ✅ **Set up professional theming** using `AppTheme.lightTheme()` and `AppTheme.darkTheme()`
3. ✅ **Implement responsive layout** with `M3AdaptiveScaffold`
4. ✅ **Apply accessibility features** using `M3Accessibility` utilities
5. ✅ **Use proper token hierarchy** following ref/sys/comp structure
6. ✅ **Integrate themes properly** - avoid static token usage in components
7. ✅ **Add motion patterns** with `M3MotionUtils` for polished interactions
8. ✅ **Test across devices** to ensure adaptive design works properly
9. ✅ **Validate accessibility** using screen readers and contrast checkers
10. ✅ **Optimize performance** with theme caching and efficient layouts

### Live Examples

For comprehensive examples and interactive demos, visit:

[https://flutterweb-wasm.web.app/](https://flutterweb-wasm.web.app/)

**What you'll find:**

- **Complete Component Library**: All M3 components with proper theme integration
- **Responsive Dashboard**: Multi-pane adaptive layouts  
- **Accessibility Playground**: WCAG-compliant component demonstrations
- **Animation Patterns**: Context-aware motion examples
- **Theme Customization**: Dynamic color scheme generation
- **Performance Benchmarks**: Optimized implementations
- **Professional Examples**: Real-world usage patterns

---

**This Material Design 3 library provides everything you need to build beautiful, accessible, and responsive Flutter applications that fully comply with Google's Material Design 3 guidelines. The comprehensive token system, professional theme integration, advanced utilities, and adaptive components make it easy to create production-ready apps that work seamlessly across all platforms and devices.**
