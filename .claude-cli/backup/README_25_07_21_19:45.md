# Material Design 3 Only

[![pub version](https://img.shields.io/pub/v/material_design.svg)](https://pub.dev/packages/material_design)
[![license](https://img.shields.io/badge/license-BSD-blue.svg)](/LICENSE)

A **comprehensive and enhanced** toolkit for implementing Material Design 3 in Flutter. Build beautiful, accessible, and responsive UIs aligned with official metrics and guidelines using a powerful set of design tokens, accessibility utilities, adaptive patterns, and ready-to-use helper widgets.

This package provides a **complete implementation** of [Material 3](https://m3.material.io/) guidelines with enhanced features including accessibility support, adaptive design patterns, comprehensive theme integration, and advanced animation utilities.

## Installation

Add this line to your project's `pubspec.yaml` file:

```yaml
dependencies:
  material_design: ^0.6.0
```

Then run `flutter pub get`.

## Usage

Import the package to start using the tokens:

```dart
import 'package:material_design/material_design.dart';
```

## üåü Enhanced Features

This library provides a complete, well-organized implementation of Material Design 3 following the official token structure:

### ‚ú® What's New in v0.6.0

- **üìê Official Token Structure** - Organized following M3's ref/sys/comp token hierarchy
- **üé® Complete M3 Theme System** - Integrated theme builder with seamless Flutter integration
- **‚ôø Accessibility Features** - WCAG-compliant utilities and automatic configuration
- **üì± Adaptive Design** - Responsive layouts that work across all screen sizes
- **üéØ Advanced Tokens** - Enhanced typography, colors, elevation, motion, and shapes
- **üé¨ Motion Patterns** - Advanced animation utilities with contextual behaviors
- **üéõÔ∏è Comprehensive Examples** - Reorganized showcase following M3 foundations/styles/components structure

### üöÄ Quick Start with Enhanced Features

```dart
import 'package:material_design/material_design.dart';

void main() {
  runApp(MyApp());
}

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      title: 'Enhanced Material Design 3',
      // Use the enhanced M3 theme system
      theme: M3Theme.light(seedColor: Colors.blue).toThemeData(),
      darkTheme: M3Theme.dark(seedColor: Colors.blue).toThemeData(),
      home: M3AdaptiveScaffold(
        destinations: const [
          NavigationDestination(icon: Icon(Icons.home), label: 'Home'),
          NavigationDestination(icon: Icon(Icons.search), label: 'Search'),
        ],
        selectedIndex: 0,
        onDestinationSelected: (index) {},
        body: const MyHomePage(),
      ),
    );
  }
}
```

## üìã Token Architecture

This package follows the official Material Design 3 token structure for maximum consistency and scalability:

### üèóÔ∏è Token Hierarchy

#### Reference Tokens (Ref)

Foundation tokens that define the basic design decisions:

- **Color Palettes**: 13-tone color palettes for all color families
- **Typography**: Base typeface definitions and font families
- **Motion**: Fundamental duration and easing curve values
- **Opacity**: Base opacity levels for interaction states

#### System Tokens (Sys)

Semantic tokens that map reference tokens to design intentions:

- **Color Roles**: Primary, secondary, tertiary, error, surface colors
- **Typography Scale**: 15 semantic text styles from display to label
- **Elevation System**: Tonal surface colors and shadow specifications
- **Motion Patterns**: Contextual animation specifications

#### Component Tokens (Comp)

Specific tokens for individual UI components:

- **Button Tokens**: Heights, paddings, radiuses, elevation states
- **Card Tokens**: Elevation levels, shape specifications
- **Dialog Tokens**: Sizing, spacing, and layout specifications
- **Navigation Tokens**: Sizes, spacing for different navigation types

### üéØ Using the New Token Structure

#### Reference Tokens

```dart
// Access color palettes
final primaryColor = M3RefPalette.getColor(M3RefPalette.primary, 40);
final surfaceColor = M3RefPalette.getColor(M3RefPalette.neutral, 99);

// Typography foundations
final fontFamily = M3RefTypeface.brand; // 'Roboto'
final fontWeight = M3RefTypeface.labelWeight; // 500

// Base motion values
final shortDuration = M3RefDuration.short1; // 250ms
final standardCurve = M3MotionEasing.standard;
```

#### System Tokens

```dart
// Semantic color roles
Container(
  color: M3SysColor.primaryContainer,
  child: Text(
    'System color',
    style: TextStyle(color: M3SysColor.onPrimaryContainer),
  ),
)

// Dark theme colors
final darkScheme = M3SysColorDark.toColorScheme();
```

#### Component Tokens

```dart
// Button specifications
ElevatedButton(
  style: ElevatedButton.styleFrom(
    minimumSize: Size.fromHeight(M3CompButton.heightMedium),
    padding: M3CompButton.paddingMedium,
    shape: RoundedRectangleBorder(
      borderRadius: M3CompButton.shapeMedium,
    ),
  ),
  onPressed: () {},
  child: const Text('Styled Button'),
)
```

### üéØ Legacy Token Categories

### Color

The color system is based on a seed color, which generates a full `ColorScheme` for both light and dark modes.

- **`ColorScheme.fromSeed({seedColor, brightness})`**: Generates a full M3 color scheme.

**Example:**

```dart
MaterialApp(
  theme: ThemeData(
    useMaterial3: true,
    colorScheme: ColorScheme.fromSeed(
      seedColor: Colors.blue,
      brightness: Brightness.light,
    ),
  ),
  darkTheme: ThemeData(
    useMaterial3: true,
    colorScheme: ColorScheme.fromSeed(
      seedColor: Colors.blue,
      brightness: Brightness.dark,
    ),
  ),
)
```

- **`M3TonalColor.fromElevation(context, elevation)`**: Calculates the surface color with an elevation-based tint, crucial for M3's tonal elevation.

**Example:**

```dart
Container(
  color: M3TonalColor.fromElevation(context, M3Elevation.level2),
)
```

### Typography

The full M3 type scale is available via the `M3TypeScale` class.

- **`M3TypeScale`**: Provides 15 `TextStyle` tokens, from `displayLarge` to `labelSmall`.

**Example:**

```dart
MaterialApp(
  theme: ThemeData(
    useMaterial3: true,
    textTheme: TextTheme(
      displayLarge: M3TypeScale.displayLarge,
      displayMedium: M3TypeScale.displayMedium,
      displaySmall: M3TypeScale.displaySmall,
      ...
    ),
  ),
)
```

```dart
final textTheme = Theme.of(context).textTheme;
Text(
  'Display Large',
  style: textTheme.displayLarge,
)
```

### Shape & Radius

Define corner shapes using radius and shape tokens.

- **`M3Radius`**: Provides radius values from `none` (0dp) to `extraLarge` (28dp) and `full`.
- **`M3Shape`**: Provides `ShapeBorder` objects like `extraSmall`, `medium`, `large`, etc.

**Example:**

```dart
Container(
  decoration: ShapeDecoration(
    shape: M3Shape.medium, // 12dp corner radius
  ),
)
```

### Elevation

Use elevation tokens for surface depth and shadow tokens for casting shadows.

- **`M3Elevation`**: Defines 6 elevation levels from `level0` (0dp) to `level5` (12dp).
- **`M3Shadow`**: Provides `BoxShadow` lists for each elevation level (`level0` to `level5`).

**Example:**

```dart
final useShadow = true;
final elevation = M3Elevation.level5;
final elevationSurfaceColor = M3TonalColor.fromElevation(context, elevation);
final elevationShadows = useShadow ? M3Shadow.fromElevation(elevation) : <BoxShadow>[];
Container(
  decoration: ShapeDecoration(
    shape: M3Shape.small,
    color: elevationSurfaceColor,
    shadows: elevationShadows,
  ),
),
```

### Spacing & Layout

A granular scale for consistent spacing, margins, and layouts.

- **`M3Spacing`**: Provides spacing values from `none` to `space128` based on a 4dp grid. Ideal for padding and small gaps between UI elements.

**Example:**

```dart
Padding(
  padding: const EdgeInsets.all(M3Spacing.space16), // 16dp padding
  child: Text('Hello, Material!'),
)
```

- **`M3Margin`**: Provides semantic margin values for the outer edges of the screen layout.

  - screen (16dp) for compact.

  - screenLarge (24dp) for medium/expanded/large/extra-large screens.

**Example:**

```dart
Container(
  margin: const EdgeInsets.symmetric(horizontal: M3Margin.mediumScreen),
  child: Text('Content with screen margins'),
)
```

- **`M3Spacer`**: pane (24dp) for the gap between two content panes.

  - screen (16dp) for compact/medium screens.

  - screenLarge (24dp) for large/extra-large screens.

**Example:**

```dart
Row(
  children: [
    Expanded(child: ContentPane1()),
    const SizedBox(width: M3Spacer.pane),
    Expanded(child: ContentPane2()),
  ],
)
```

### Density

Adjust component density for different interaction models.

- **`M3Density`**: An enum with `comfortable` (default) and `compact` values.

**Example:**

```dart
// Use a switch to toggle between density settings
final density = isCompact ? M3Density.compact : M3Density.comfortable;

// This could be used to adjust layout constraints
final horizontalPadding = density == M3Density.compact
    ? M3Spacing.space8
    : M3Spacing.space16;
```

### Motion

Standardized duration and easing curves for animations.

- **`M3MotionDuration`**: Provides duration values from `short1` to `extralong4`.
- **`M3MotionEasing`**: Provides duration values from `emphasizedAccelerate` to `standardDecelerate`.

**Example:**

```dart
AnimatedContainer(
  duration: M3MotionDuration.long2,
  curve: M3MotionEasing.emphasizedAccelerate,
  // ...
)
```

### Other Tokens

The library also includes tokens for various other UI properties.

- **`M3Border`**: Standard border widths.

  - `thin` (1dp)

  **Example:**

  ```dart
  Container(
    decoration: BoxDecoration(
      border: Border.all(width: M3Border.thin),
    ),
  )
  ```

- **`M3StateLayerOpacity`**: Opacity values for states and elements.

  - `hover` (0.08), `focus` (0.10), `pressed` (0.10), `dragged` (0.16)
  - `disabledContent` (0.38), `disabledContainer` (0.12)

  **Example:**

```dart
// Apply a state layer overlay for interaction feedback
final isPressed = true;
final stateLayerOpacity = isPressed ? M3StateLayerOpacity.pressed : 0.0;

Stack(
  children: [
    // Main widget content
     Positioned.fill(
      child: AnimatedContainer(
        duration: M3MotionDuration.short3,
        decoration: BoxDecoration(
          color: Theme.of(context).colorScheme.primary.withOpacity(stateLayerOpacity),
        ),
      ),
    ),
  ],
)
```

- **`M3Breakpoint`**: Breakpoints for responsive layouts.

- `compact` (0), `medium` (600), `expanded` (840), `large` (1200), `extraLarge` (1600)

**Example:**

```dart
final screenWidth = MediaQuery.of(context).size.width;
if (screenWidth >= M3Breakpoint.medium) {
  // Use a two-column layout
}
```

- **`M3IconSize`**: Standard icon size.

  - `standard` (24dp)

  **Example:**

  ```dart
  Icon(
    Icons.favorite,
    size: M3IconSize.standard,
  )
  ```

- **`M3ZIndex`**: Conventional z-index values for layering.

  - `content` (1), `floating` (10), `drawer` (100), `modal` (1000), `snackbar` (2000), `tooltip` (9999)

  **Example:**

  ```dart
  Stack(
    children: [
      Positioned(
        zIndex: M3ZIndex.content,
        child: Text('Content'),
      ),
      Positioned(
        zIndex: M3ZIndex.floating,
        child: FloatingActionButton(onPressed: () {}),
      ),
    ],
  )
  ```

## üé® Enhanced Material Design 3 Features

### üéØ Complete Token System

#### Enhanced Typography

- **Responsive Scales**: Typography that adapts to screen size
- **Accessibility**: Support for high-contrast text and enhanced readability
- **Font Families**: Full support for Roboto and system fonts
- **Utilities**: Helper functions for manipulating text styles

```dart
// Responsive text that adapts to screen size
Text(
  'Responsive Title',
  style: M3TypeScale.responsiveDisplay(context),
)

// Text with enhanced readability for accessibility
Text(
  'Accessible Text',
  style: M3TypeScale.enhancedReadability(M3TypeScale.bodyLarge),
)

// Adaptive text that scales with user preferences
Text(
  'Adaptive Text',
  style: M3TypeScale.adaptive(
    baseStyle: M3TypeScale.bodyLarge,
    context: context,
  ),
)
```

#### Advanced Color System

- **Complete Color Roles**: Primary, Secondary, Tertiary, Error, Surface
- **Tonal Colors**: Complete system of surfaces with elevation
- **Color Utilities**: Manipulation, mixing, and contrast validation
- **Material You**: Support for dynamic color schemes

```dart
// Using pre-defined color roles
Container(
  color: M3ColorRoles.primaryContainer,
  child: Text(
    'Text in primary container',
    style: TextStyle(color: M3ColorRoles.onPrimaryContainer),
  ),
)

// Surface colors with elevation
Container(
  color: M3TonalColor.surface3(context), // 6dp elevation
  child: const Text('Elevated Surface'),
)

// Contrast check for accessibility
final hasGoodContrast = M3ColorUtils.meetsWCAGAA(
  foregroundColor,
  backgroundColor,
);
```

#### Advanced Elevation and Shadows

- **Contextual Elevation Levels**: Component-specific elevation
- **Interpolated Shadows**: Smooth transitions between levels
- **Interactive States**: Elevation for hover, pressed, focus
- **Elevation Animations**: Fluid transitions

```dart
// Contextual elevation by component
final cardElevation = M3Elevation.forComponent('card', state: 'hover');

// Interpolated shadows
final shadows = M3Shadow.fromElevation(4.5); // Interpolates between levels

// Container with animated elevation
AnimatedContainer(
  duration: M3MotionDuration.short4,
  decoration: BoxDecoration(
    color: M3TonalColor.surfaceAt(context, elevation),
    boxShadow: M3Shadow.fromElevation(elevation),
  ),
  child: child,
)
```

#### Motion and Animation System

- **Contextual Durations**: Appropriate duration by component type
- **Easing Curves**: Official M3 curves for different contexts
- **Animation Patterns**: Fade, slide, scale, and combined transitions
- **Motion Utilities**: Helpers for common animations

```dart
// Contextual duration
final duration = M3MotionUtils.durationForComponent('dialog', 'enter');

// Fade-in animation
M3MotionUtils.fadeIn(
  duration: M3MotionDuration.medium2,
  curve: M3MotionEasing.emphasizedDecelerate,
  child: myWidget,
)

// Combined slide and fade animation
M3MotionUtils.slideAndFade(
  slideOffset: const Offset(0, 30),
  child: myWidget,
)
```

### üéõÔ∏è Integrated Theme System

#### Complete Theme Builder

- **Light/Dark Themes**: Full implementation with official M3 colors
- **High Contrast**: Automatic support for high contrast mode
- **Dynamic Themes**: Generation from a seed color
- **Flutter Integration**: Seamless conversion to ThemeData

```dart
// Light theme with a custom color
final lightTheme = M3Theme.light(
  seedColor: Colors.blue,
  visualDensity: VisualDensity.comfortable,
).toThemeData();

// High contrast theme
final highContrastTheme = M3Theme.light().toHighContrast().toThemeData();

// Usage in MaterialApp
MaterialApp(
  theme: lightTheme,
  darkTheme: M3Theme.dark().toThemeData(),
  home: MyApp(),
)
```

### ‚ôø Accessibility Features

#### Complete Accessibility Utilities

- **Minimum Touch Sizes**: Ensuring adequate targets
- **Color Contrast**: WCAG validation and automatic adjustment
- **Visible Focus**: Accessible focus indicators
- **Reduced Motion**: Support for motion preferences

```dart
// Accessible button with minimum target
M3Accessibility.accessibleButton(
  onPressed: () {},
  semanticLabel: 'Submit button',
  tooltip: 'Submits the form',
  child: const Text('Submit'),
)

// Accessible text field
M3Accessibility.accessibleTextField(
  label: 'Email',
  hint: 'Enter your email',
  required: true,
  keyboardType: TextInputType.emailAddress,
)

// Contrast check
final meetsStandards = M3Accessibility.meetsContrastRequirement(
  foreground: textColor,
  background: backgroundColor,
  useEnhanced: true, // WCAG AAA
);
```

### üì± Adaptive Design

#### Responsive Layouts

- **M3 Breakpoints**: Official window class system
- **Adaptive Navigation**: Automatic navigation bar, rail, and drawer
- **Flexible Layouts**: Components that adapt to screen size
- **Input Detection**: Adaptation for touch vs. mouse

```dart
// Adaptive scaffold with automatic navigation
M3AdaptiveScaffold(
  destinations: navigationDestinations,
  selectedIndex: currentIndex,
  onDestinationSelected: onNavigation,
  body: content,
)

// Responsive layout
M3Adaptive.responsiveLayout(
  context: context,
  compact: mobileLayout,
  medium: tabletLayout,
  expanded: desktopLayout,
)

// Responsive values
final columns = M3Adaptive.responsiveValue<int>(
  context: context,
  compact: 1,
  medium: 2,
  expanded: 3,
);
```

#### Adaptive Dialogs and Sheets

- **Adaptive Dialogs**: Modal on desktop, fullscreen on mobile
- **Bottom/Side Sheets**: Automatic adaptation based on screen size
- **Contextual Animations**: Appropriate transitions for each platform

```dart
// Dialog that adapts to screen size
M3Adaptive.showAdaptiveDialog(
  context: context,
  title: 'Settings',
  content: settingsForm,
  actions: dialogActions,
);

// Adaptive sheet
M3Adaptive.showAdaptiveSheet(
  context: context,
  title: 'Options',
  child: optionsWidget,
);
```

## üìã Implementation Status

### ‚úÖ Fully Implemented Features

- **Typography**: Full scale + responsive and accessible utilities
- **Colors**: Complete role system + utilities + Material You
- **Elevation**: Contextual levels + interpolated shadows + animations
- **Motion**: Contextual durations + M3 curves + animation patterns
- **Shapes**: Full scale + families + responsive utilities
- **Spacing**: 4dp system + contextual margins + utilities
- **Breakpoints**: M3 window classes + responsive utilities
- **Borders**: Complete system + contextual utilities
- **Shadows**: Interpolated shadows + interactive states
- **Opacity**: Interaction states + utilities
- **Integrated Theme**: Complete M3Theme with conversion to ThemeData
- **Accessibility**: WCAG utilities + automatic configuration
- **Adaptive Design**: Responsive layouts + automatic navigation
- **Example Widgets**: Functional demonstrations of all features

## Example App

The included example app has been completely reorganized to follow Material Design 3's official structure:

### üì± New Organized Structure

#### üèóÔ∏è Foundations

- **Design Tokens**: Complete showcase of spacing, density, breakpoints, and other foundational tokens
- **Accessibility**: WCAG-compliant features, contrast validation, and touch targets
- **Adaptive Design**: Responsive breakpoints and adaptive navigation patterns

#### üé® Styles

- **Color System**: Full color roles, palettes, and tonal variations
- **Typography**: Complete type scale with responsive and accessible variations
- **Elevation**: Surface elevation with shadows and tonal colors
- **Shape**: Border radius system and shape families
- **Motion**: Animation patterns, durations, and easing curves

#### üß© Components

- **Component Showcase**: Buttons, cards, inputs, and navigation using M3 tokens
- **Enhanced Features**: Advanced implementations with accessibility and responsiveness

### üéØ What You'll See

- **Token Organization**: Clear demonstration of ref/sys/comp token hierarchy
- **Practical Implementation**: Real components built with the new token structure
- **Interactive Examples**: Live demonstrations of all enhanced features
- **Responsive Design**: Adaptive layouts working across different screen sizes
- **Accessibility**: WCAG-compliant components in action

The example app now serves as both a comprehensive style guide and a practical implementation reference for Material Design 3.

### üîß Advanced Utility Classes

### M3ColorUtils

Comprehensive color manipulation and validation utilities:

```dart
// Validate WCAG contrast compliance
final hasAAContrast = M3ColorUtils.meetsWCAGAA(
  foregroundColor: Colors.black,
  backgroundColor: Colors.white,
);

final hasAAAContrast = M3ColorUtils.meetsWCAGAAA(
  foregroundColor: textColor,
  backgroundColor: surfaceColor,
);

// Automatic contrast adjustment
final adjustedColor = M3ColorUtils.adjustForContrast(
  foregroundColor: Colors.grey.shade600,
  backgroundColor: Colors.white,
  targetRatio: 4.5, // WCAG AA
);

// Color mixing and blending
final blendedColor = M3ColorUtils.blend(
  color1: Colors.blue,
  color2: Colors.red,
  ratio: 0.3,
);

// Get appropriate text color for any background
final textColor = M3ColorUtils.getTextColorForBackground(backgroundColor);
```

### M3ShapeUtils

Advanced shape manipulation and responsive utilities:

```dart
// Responsive shape based on screen size
final responsiveShape = M3ShapeUtils.responsiveShape(
  context: context,
  compact: M3Shape.small,
  medium: M3Shape.medium,
  expanded: M3Shape.large,
);

// Brand-specific shape variants
final brandShape = M3ShapeUtils.brandShape(
  baseShape: M3Shape.medium,
  brandMultiplier: 1.5,
);

// Asymmetric shape creation
final asymmetricShape = M3ShapeUtils.asymmetric(
  topLeft: M3Radius.large,
  topRight: M3Radius.small,
  bottomLeft: M3Radius.small,
  bottomRight: M3Radius.large,
);

// Shape family generation
final shapeFamily = M3ShapeUtils.generateFamily(
  baseRadius: 12.0,
  steps: [0.5, 1.0, 1.5, 2.0],
);
```

### M3MotionUtils

Context-aware animation utilities:

```dart
// Component-specific animation duration
final duration = M3MotionUtils.durationForComponent(
  'dialog',
  'enter',
);

// Distance-based animation duration
final distanceDuration = M3MotionUtils.durationForDistance(
  distance: 200.0,
  velocity: 'medium',
);

// Contextual easing curve
final curve = M3MotionUtils.curveForContext('navigation');

// Pre-built animation patterns
Widget fadeInWidget = M3MotionUtils.fadeIn(
  duration: M3MotionDuration.medium2,
  curve: M3MotionEasing.emphasizedDecelerate,
  child: myWidget,
);

Widget slideUpWidget = M3MotionUtils.slideUp(
  distance: 30.0,
  duration: M3MotionDuration.short4,
  child: myWidget,
);

Widget scaleInWidget = M3MotionUtils.scaleIn(
  fromScale: 0.8,
  child: myWidget,
);

// Combined animations
Widget combinedAnimation = M3MotionUtils.slideAndFade(
  slideOffset: const Offset(0, 30),
  fadeOpacity: AnimationController(vsync: this),
  child: myWidget,
);
```

## ‚ôø Complete Accessibility System

### M3Accessibility Configuration

```dart
// Global accessibility configuration
M3AccessibilityConfig.configure(
  enforceMinimumTouchTargets: true,
  enableHighContrast: false,
  enableReducedMotion: false,
  enableDyslexiaSupport: true,
  contrastStandard: WCAGStandard.AA,
);

// Get current accessibility preferences
final config = M3AccessibilityConfig.current;
final hasHighContrast = config.isHighContrastEnabled;
final prefersReducedMotion = config.prefersReducedMotion;
```

### Accessible Widget Utilities

```dart
// Accessible button with minimum touch target
Widget accessibleButton = M3Accessibility.accessibleButton(
  onPressed: () => handleSubmit(),
  semanticLabel: 'Submit form',
  tooltip: 'Submits the registration form',
  minTouchTarget: Size(44, 44),
  child: const Text('Submit'),
);

// Accessible text field with error handling
Widget accessibleTextField = M3Accessibility.accessibleTextField(
  label: 'Email Address',
  hint: 'Enter your email address',
  helperText: 'We will never share your email',
  errorText: hasError ? 'Please enter a valid email' : null,
  required: true,
  keyboardType: TextInputType.emailAddress,
  onChanged: (value) => validateEmail(value),
);

// Accessible checkbox with proper semantics
Widget accessibleCheckbox = M3Accessibility.accessibleCheckbox(
  value: agreedToTerms,
  onChanged: (bool? value) => setState(() => agreedToTerms = value ?? false),
  label: 'I agree to the Terms of Service',
  semanticLabel: 'Agreement to Terms of Service checkbox',
);
```

### Contrast and Readability

```dart
// Enhanced readability for dyslexia support
TextStyle enhancedStyle = M3TypeScale.enhancedReadability(
  M3TypeScale.bodyLarge,
  enableDyslexiaSupport: true,
);

// High contrast text style
TextStyle highContrastStyle = M3TypeScale.highContrast(
  M3TypeScale.bodyMedium,
  contrastLevel: ContrastLevel.enhanced,
);

// Validate and adjust contrast
Color adjustedTextColor = M3Accessibility.ensureContrast(
  foregroundColor: Colors.grey.shade600,
  backgroundColor: surfaceColor,
  targetRatio: 4.5,
);
```

## üì± Advanced Adaptive Design

### M3AdaptiveScaffold

Complete responsive scaffold with automatic navigation adaptation:

```dart
class AdaptiveApp extends StatefulWidget {
  @override
  _AdaptiveAppState createState() => _AdaptiveAppState();
}

class _AdaptiveAppState extends State<AdaptiveApp> {
  int selectedIndex = 0;
  
  final destinations = const [
    NavigationDestination(
      icon: Icon(Icons.home_outlined),
      selectedIcon: Icon(Icons.home),
      label: 'Home',
    ),
    NavigationDestination(
      icon: Icon(Icons.search_outlined),
      selectedIcon: Icon(Icons.search),
      label: 'Search',
    ),
    NavigationDestination(
      icon: Icon(Icons.favorite_outline),
      selectedIcon: Icon(Icons.favorite),
      label: 'Favorites',
    ),
    NavigationDestination(
      icon: Icon(Icons.person_outline),
      selectedIcon: Icon(Icons.person),
      label: 'Profile',
    ),
  ];

  @override
  Widget build(BuildContext context) {
    return M3AdaptiveScaffold(
      destinations: destinations,
      selectedIndex: selectedIndex,
      onDestinationSelected: (index) {
        setState(() => selectedIndex = index);
      },
      // Automatically switches between:
      // - NavigationBar (compact)
      // - NavigationRail (medium/expanded) 
      // - NavigationDrawer (large/extra-large)
      body: IndexedStack(
        index: selectedIndex,
        children: const [
          HomeScreen(),
          SearchScreen(),
          FavoritesScreen(),
          ProfileScreen(),
        ],
      ),
      // Optional extended configuration
      enableNavigationRail: true,
      enableNavigationDrawer: true,
      railExtended: false,
      drawerHeader: const UserAccountsDrawerHeader(
        accountName: Text('John Doe'),
        accountEmail: Text('john.doe@example.com'),
      ),
    );
  }
}
```

### Responsive Layout Patterns

```dart
// Responsive value based on window size class
final columns = M3Adaptive.responsiveValue<int>(
  context: context,
  compact: 1,      // Mobile phones
  medium: 2,       // Small tablets, large phones
  expanded: 3,     // Tablets, small desktops
  large: 4,        // Large desktops
  extraLarge: 5,   // Very large screens
);

// Responsive layout with different widgets
Widget responsiveLayout = M3Adaptive.responsiveLayout(
  context: context,
  compact: CompactMobileLayout(),
  medium: TabletLayout(),
  expanded: DesktopLayout(),
  large: LargeDesktopLayout(),
);

// Responsive padding
EdgeInsets adaptivePadding = M3Adaptive.adaptivePadding(
  context: context,
  compact: const EdgeInsets.all(16),
  medium: const EdgeInsets.all(24),
  expanded: const EdgeInsets.all(32),
);
```

### Adaptive Dialogs and Sheets

```dart
// Dialog that adapts to screen size
void showAdaptiveDialog() {
  M3Adaptive.showAdaptiveDialog(
    context: context,
    title: 'Settings',
    content: const SettingsForm(),
    actions: [
      TextButton(
        onPressed: () => Navigator.pop(context),
        child: const Text('Cancel'),
      ),
      FilledButton(
        onPressed: () => saveSettings(),
        child: const Text('Save'),
      ),
    ],
    // Automatically chooses:
    // - Modal dialog on desktop
    // - Fullscreen dialog on mobile
  );
}

// Adaptive sheet
void showAdaptiveSheet() {
  M3Adaptive.showAdaptiveSheet(
    context: context,
    title: 'Filter Options',
    child: const FilterOptionsWidget(),
    // Automatically chooses:
    // - Bottom sheet on mobile
    // - Side sheet on desktop
  );
}
```

### Input Method Adaptation

```dart
// Adapt UI based on input method
Widget adaptiveButton = M3Adaptive.inputMethodAware(
  context: context,
  touch: ElevatedButton(
    style: ElevatedButton.styleFrom(
      minimumSize: const Size(0, 48), // Larger for touch
      padding: const EdgeInsets.symmetric(horizontal: 24),
    ),
    onPressed: onPressed,
    child: const Text('Touch Button'),
  ),
  mouse: ElevatedButton(
    style: ElevatedButton.styleFrom(
      minimumSize: const Size(0, 36), // Smaller for mouse
      padding: const EdgeInsets.symmetric(horizontal: 16),
    ),
    onPressed: onPressed,
    child: const Text('Mouse Button'),
  ),
);

// Check current input method
final inputMethod = M3Adaptive.getInputMethodType(context);
final isTouchPrimary = inputMethod == InputMethodType.touch;
```

## üé® Advanced Theme System

### Complete M3Theme Usage

```dart
// Advanced light theme with custom configuration
final advancedLightTheme = M3Theme.light(
  seedColor: const Color(0xFF6750A4),
  visualDensity: VisualDensity.comfortable,
  useMaterial3: true,
).copyWith(
  // Override specific component themes
  elevatedButtonTheme: ElevatedButtonThemeData(
    style: ElevatedButton.styleFrom(
      elevation: 2,
      shadowColor: Colors.transparent,
      minimumSize: const Size(64, 40),
    ),
  ),
  cardTheme: const CardTheme(
    elevation: 1,
    clipBehavior: Clip.antiAlias,
  ),
).toThemeData();

// High contrast theme for accessibility
final highContrastTheme = M3Theme.light(
  seedColor: Colors.blue,
).toHighContrast().toThemeData();

// Dark theme with custom accent color
final customDarkTheme = M3Theme.dark(
  seedColor: const Color(0xFFD0BCFF),
  visualDensity: VisualDensity.compact,
).toThemeData();

// Apply themes in MaterialApp
MaterialApp(
  theme: advancedLightTheme,
  darkTheme: customDarkTheme,
  highContrastTheme: highContrastTheme,
  highContrastDarkTheme: M3Theme.dark().toHighContrast().toThemeData(),
  themeMode: ThemeMode.system,
  home: const MyApp(),
)
```

### Dynamic Color Schemes

```dart
// Generate color scheme from image
Future<ColorScheme> colorSchemeFromImage(ImageProvider image) async {
  final ColorScheme scheme = await ColorScheme.fromImageProvider(
    provider: image,
    brightness: Brightness.light,
  );
  return scheme;
}

// Material You style dynamic colors (Android 12+)
Widget buildWithDynamicColors() {
  return DynamicColorBuilder(
    builder: (ColorScheme? lightDynamic, ColorScheme? darkDynamic) {
      ColorScheme lightColorScheme;
      ColorScheme darkColorScheme;

      if (lightDynamic != null && darkDynamic != null) {
        // Use dynamic colors from system
        lightColorScheme = lightDynamic.harmonized();
        darkColorScheme = darkDynamic.harmonized();
      } else {
        // Fallback to custom seed color
        lightColorScheme = ColorScheme.fromSeed(seedColor: Colors.blue);
        darkColorScheme = ColorScheme.fromSeed(
          seedColor: Colors.blue,
          brightness: Brightness.dark,
        );
      }

      return MaterialApp(
        theme: ThemeData(
          colorScheme: lightColorScheme,
          useMaterial3: true,
        ),
        darkTheme: ThemeData(
          colorScheme: darkColorScheme,
          useMaterial3: true,
        ),
        home: const MyApp(),
      );
    },
  );
}
```

## üé¨ Advanced Motion Patterns

### Component-Specific Animations

```dart
// Dialog entrance animation
Widget animatedDialog = M3MotionUtils.dialogEntrance(
  duration: M3MotionUtils.durationForComponent('dialog', 'enter'),
  curve: M3MotionEasing.emphasizedDecelerate,
  child: AlertDialog(
    title: const Text('Confirmation'),
    content: const Text('Are you sure you want to delete this item?'),
    actions: dialogActions,
  ),
);

// Navigation transition
PageRouteBuilder navigationTransition = PageRouteBuilder(
  pageBuilder: (context, animation, _) => const NextScreen(),
  transitionsBuilder: (context, animation, _, child) {
    return M3MotionUtils.navigationTransition(
      animation: animation,
      slideDirection: SlideDirection.fromRight,
      child: child,
    );
  },
  transitionDuration: M3MotionUtils.durationForComponent('navigation', 'transition'),
);

// Staggered list animation
class StaggeredListView extends StatelessWidget {
  final List<Widget> children;

  const StaggeredListView({Key? key, required this.children}) : super(key: key);

  @override
  Widget build(BuildContext context) {
    return ListView.builder(
      itemCount: children.length,
      itemBuilder: (context, index) {
        return M3MotionUtils.staggeredAnimation(
          delay: Duration(milliseconds: index * 100),
          duration: M3MotionDuration.medium2,
          curve: M3MotionEasing.standardDecelerate,
          child: children[index],
        );
      },
    );
  }
}
```

### Advanced Animation Patterns

```dart
// Morphing container animation
class MorphingContainer extends StatefulWidget {
  @override
  _MorphingContainerState createState() => _MorphingContainerState();
}

class _MorphingContainerState extends State<MorphingContainer>
    with SingleTickerProviderStateMixin {
  late AnimationController _controller;
  late Animation<BorderRadius> _borderRadiusAnimation;
  late Animation<Color> _colorAnimation;
  late Animation<double> _elevationAnimation;

  @override
  void initState() {
    super.initState();
    _controller = AnimationController(
      duration: M3MotionDuration.long2,
      vsync: this,
    );

    _borderRadiusAnimation = BorderRadiusTween(
      begin: M3Shape.small.borderRadius,
      end: M3Shape.large.borderRadius,
    ).animate(CurvedAnimation(
      parent: _controller,
      curve: M3MotionEasing.emphasizedDecelerate,
    ));

    _colorAnimation = ColorTween(
      begin: M3SysColor.primaryContainer,
      end: M3SysColor.secondaryContainer,
    ).animate(CurvedAnimation(
      parent: _controller,
      curve: M3MotionEasing.standard,
    ));

    _elevationAnimation = Tween<double>(
      begin: M3Elevation.level1,
      end: M3Elevation.level4,
    ).animate(CurvedAnimation(
      parent: _controller,
      curve: M3MotionEasing.standardAccelerate,
    ));
  }

  @override
  Widget build(BuildContext context) {
    return AnimatedBuilder(
      animation: _controller,
      builder: (context, child) {
        return Container(
          width: 200,
          height: 100,
          decoration: BoxDecoration(
            color: _colorAnimation.value,
            borderRadius: _borderRadiusAnimation.value,
            boxShadow: M3Shadow.fromElevation(_elevationAnimation.value),
          ),
          child: child,
        );
      },
      child: InkWell(
        onTap: () {
          _controller.isCompleted
              ? _controller.reverse()
              : _controller.forward();
        },
        child: const Center(
          child: Text('Tap to morph'),
        ),
      ),
    );
  }
}
```

## üéØ Advanced Token Usage

### Token Interpolation

```dart
// Color interpolation between tonal palette values
final interpolatedColor = M3RefPalette.interpolateTone(
  palette: M3RefPalette.primary,
  tone: 45.5, // Between tone40 and tone50
);

// Shadow interpolation for micro-interactions
final hoverShadow = M3Shadow.fromElevation(1.5); // Between level1 and level2
final pressedShadow = M3Shadow.fromElevation(0.5); // Between level0 and level1

// Responsive elevation based on screen density
final responsiveElevation = M3Adaptive.responsiveValue<double>(
  context: context,
  compact: M3Elevation.level1,
  medium: M3Elevation.level2,
  expanded: M3Elevation.level3,
);
```

### Custom Component Tokens

```dart
// Create custom component tokens following M3 patterns
class CustomCardTokens {
  static const double heightCompact = 200.0;
  static const double heightMedium = 240.0;
  static const double heightLarge = 280.0;
  
  static const EdgeInsets paddingContent = EdgeInsets.all(16.0);
  static const EdgeInsets paddingAction = EdgeInsets.fromLTRB(16, 8, 16, 16);
  
  static final BorderRadius shapeDefault = M3Shape.large.borderRadius;
  static final BorderRadius shapeBrand = M3Shape.extraLarge.borderRadius;
  
  static const double elevationDefault = M3Elevation.level1;
  static const double elevationHover = M3Elevation.level2;
  static const double elevationPressed = M3Elevation.level0;
}

// Use custom tokens in components
Widget customCard({
  required Widget content,
  required VoidCallback? onTap,
  CardVariant variant = CardVariant.default_,
}) {
  return Card(
    elevation: CustomCardTokens.elevationDefault,
    shape: RoundedRectangleBorder(
      borderRadius: variant == CardVariant.brand
          ? CustomCardTokens.shapeBrand
          : CustomCardTokens.shapeDefault,
    ),
    child: InkWell(
      onTap: onTap,
      borderRadius: CustomCardTokens.shapeDefault,
      child: Container(
        height: CustomCardTokens.heightMedium,
        padding: CustomCardTokens.paddingContent,
        child: content,
      ),
    ),
  );
}
```

## üîç Complete Usage Examples

### Building a Professional Form

```dart
class ProfessionalForm extends StatefulWidget {
  @override
  _ProfessionalFormState createState() => _ProfessionalFormState();
}

class _ProfessionalFormState extends State<ProfessionalForm> {
  final _formKey = GlobalKey<FormState>();
  final _nameController = TextEditingController();
  final _emailController = TextEditingController();
  bool _acceptTerms = false;
  bool _isSubmitting = false;

  @override
  Widget build(BuildContext context) {
    return M3AdaptiveScaffold(
      destinations: const [],
      selectedIndex: 0,
      onDestinationSelected: (_) {},
      body: Padding(
        padding: M3Adaptive.adaptivePadding(
          context: context,
          compact: const EdgeInsets.all(M3Spacing.space16),
          medium: const EdgeInsets.all(M3Spacing.space24),
          expanded: const EdgeInsets.all(M3Spacing.space32),
        ),
        child: Center(
          child: Container(
            constraints: const BoxConstraints(maxWidth: 400),
            child: Card(
              elevation: M3Elevation.level2,
              shape: RoundedRectangleBorder(
                borderRadius: M3Shape.large.borderRadius,
              ),
              child: Padding(
                padding: const EdgeInsets.all(M3Spacing.space24),
                child: Form(
                  key: _formKey,
                  child: Column(
                    mainAxisSize: MainAxisSize.min,
                    crossAxisAlignment: CrossAxisAlignment.stretch,
                    children: [
                      // Title
                      Text(
                        'Registration Form',
                        style: M3TypeScale.headlineMedium,
                        textAlign: TextAlign.center,
                      ),
                      const SizedBox(height: M3Spacing.space24),
                      
                      // Name field with accessibility
                      M3Accessibility.accessibleTextField(
                        controller: _nameController,
                        label: 'Full Name',
                        hint: 'Enter your full name',
                        required: true,
                        keyboardType: TextInputType.name,
                        textInputAction: TextInputAction.next,
                        validator: (value) {
                          if (value == null || value.isEmpty) {
                            return 'Please enter your name';
                          }
                          return null;
                        },
                      ),
                      const SizedBox(height: M3Spacing.space16),
                      
                      // Email field with accessibility
                      M3Accessibility.accessibleTextField(
                        controller: _emailController,
                        label: 'Email Address',
                        hint: 'Enter your email address',
                        helperText: 'We will never share your email',
                        required: true,
                        keyboardType: TextInputType.emailAddress,
                        textInputAction: TextInputAction.done,
                        validator: (value) {
                          if (value == null || value.isEmpty) {
                            return 'Please enter your email';
                          }
                          if (!value.contains('@')) {
                            return 'Please enter a valid email address';
                          }
                          return null;
                        },
                      ),
                      const SizedBox(height: M3Spacing.space16),
                      
                      // Checkbox with accessibility
                      M3Accessibility.accessibleCheckbox(
                        value: _acceptTerms,
                        onChanged: (value) {
                          setState(() => _acceptTerms = value ?? false);
                        },
                        label: 'I agree to the Terms of Service',
                        semanticLabel: 'Agreement to Terms of Service checkbox',
                      ),
                      const SizedBox(height: M3Spacing.space24),
                      
                      // Submit button with proper touch target
                      M3Accessibility.accessibleButton(
                        onPressed: _acceptTerms && !_isSubmitting
                            ? _handleSubmit
                            : null,
                        semanticLabel: 'Submit registration form',
                        tooltip: 'Submits the registration form',
                        child: _isSubmitting
                            ? const Row(
                                mainAxisAlignment: MainAxisAlignment.center,
                                children: [
                                  SizedBox(
                                    width: 20,
                                    height: 20,
                                    child: CircularProgressIndicator(
                                      strokeWidth: 2,
                                    ),
                                  ),
                                  SizedBox(width: M3Spacing.space8),
                                  Text('Submitting...'),
                                ],
                              )
                            : const Text('Submit'),
                      ),
                    ],
                  ),
                ),
              ),
            ),
          ),
        ),
      ),
    );
  }

  Future<void> _handleSubmit() async {
    if (!_formKey.currentState!.validate()) return;

    setState(() => _isSubmitting = true);

    // Simulate API call
    await Future.delayed(const Duration(seconds: 2));

    setState(() => _isSubmitting = false);

    if (mounted) {
      ScaffoldMessenger.of(context).showSnackBar(
        const SnackBar(
          content: Text('Registration successful!'),
          behavior: SnackBarBehavior.floating,
        ),
      );
    }
  }

  @override
  void dispose() {
    _nameController.dispose();
    _emailController.dispose();
    super.dispose();
  }
}
```

### Responsive Dashboard Layout

```dart
class ResponsiveDashboard extends StatefulWidget {
  @override
  _ResponsiveDashboardState createState() => _ResponsiveDashboardState();
}

class _ResponsiveDashboardState extends State<ResponsiveDashboard> {
  int selectedIndex = 0;

  @override
  Widget build(BuildContext context) {
    return M3AdaptiveScaffold(
      destinations: const [
        NavigationDestination(
          icon: Icon(Icons.dashboard_outlined),
          selectedIcon: Icon(Icons.dashboard),
          label: 'Dashboard',
        ),
        NavigationDestination(
          icon: Icon(Icons.analytics_outlined),
          selectedIcon: Icon(Icons.analytics),
          label: 'Analytics',
        ),
        NavigationDestination(
          icon: Icon(Icons.people_outline),
          selectedIcon: Icon(Icons.people),
          label: 'Users',
        ),
        NavigationDestination(
          icon: Icon(Icons.settings_outlined),
          selectedIcon: Icon(Icons.settings),
          label: 'Settings',
        ),
      ],
      selectedIndex: selectedIndex,
      onDestinationSelected: (index) {
        setState(() => selectedIndex = index);
      },
      body: M3Adaptive.responsiveLayout(
        context: context,
        compact: _buildCompactLayout(),
        medium: _buildMediumLayout(),
        expanded: _buildExpandedLayout(),
        large: _buildLargeLayout(),
      ),
    );
  }

  Widget _buildCompactLayout() {
    return SingleChildScrollView(
      padding: const EdgeInsets.all(M3Spacing.space16),
      child: Column(
        children: [
          _buildStatsCard(title: 'Total Users', value: '12,345', isCompact: true),
          const SizedBox(height: M3Spacing.space16),
          _buildStatsCard(title: 'Revenue', value: '\$45,678', isCompact: true),
          const SizedBox(height: M3Spacing.space16),
          _buildChartCard(isCompact: true),
        ],
      ),
    );
  }

  Widget _buildMediumLayout() {
    return Padding(
      padding: const EdgeInsets.all(M3Spacing.space24),
      child: Column(
        children: [
          Row(
            children: [
              Expanded(
                child: _buildStatsCard(title: 'Total Users', value: '12,345'),
              ),
              const SizedBox(width: M3Spacing.space16),
              Expanded(
                child: _buildStatsCard(title: 'Revenue', value: '\$45,678'),
              ),
            ],
          ),
          const SizedBox(height: M3Spacing.space24),
          Expanded(
            child: _buildChartCard(),
          ),
        ],
      ),
    );
  }

  Widget _buildExpandedLayout() {
    return Padding(
      padding: const EdgeInsets.all(M3Spacing.space32),
      child: Row(
        children: [
          Expanded(
            flex: 2,
            child: Column(
              children: [
                Row(
                  children: [
                    Expanded(
                      child: _buildStatsCard(title: 'Total Users', value: '12,345'),
                    ),
                    const SizedBox(width: M3Spacing.space16),
                    Expanded(
                      child: _buildStatsCard(title: 'Revenue', value: '\$45,678'),
                    ),
                    const SizedBox(width: M3Spacing.space16),
                    Expanded(
                      child: _buildStatsCard(title: 'Orders', value: '1,234'),
                    ),
                  ],
                ),
                const SizedBox(height: M3Spacing.space24),
                Expanded(child: _buildChartCard()),
              ],
            ),
          ),
          const SizedBox(width: M3Spacer.pane),
          Expanded(
            flex: 1,
            child: _buildSidePanel(),
          ),
        ],
      ),
    );
  }

  Widget _buildLargeLayout() {
    return _buildExpandedLayout(); // Same as expanded for this example
  }

  Widget _buildStatsCard({
    required String title,
    required String value,
    bool isCompact = false,
  }) {
    return Card(
      elevation: M3Elevation.level1,
      child: Padding(
        padding: EdgeInsets.all(
          isCompact ? M3Spacing.space16 : M3Spacing.space20,
        ),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            Text(
              title,
              style: isCompact
                  ? M3TypeScale.labelMedium
                  : M3TypeScale.labelLarge,
            ),
            const SizedBox(height: M3Spacing.space8),
            Text(
              value,
              style: isCompact
                  ? M3TypeScale.headlineSmall
                  : M3TypeScale.headlineMedium,
            ),
          ],
        ),
      ),
    );
  }

  Widget _buildChartCard({bool isCompact = false}) {
    return Card(
      elevation: M3Elevation.level1,
      child: Padding(
        padding: EdgeInsets.all(
          isCompact ? M3Spacing.space16 : M3Spacing.space24,
        ),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            Text(
              'Analytics Overview',
              style: isCompact
                  ? M3TypeScale.titleMedium
                  : M3TypeScale.titleLarge,
            ),
            const SizedBox(height: M3Spacing.space16),
            Expanded(
              child: Container(
                decoration: BoxDecoration(
                  color: Theme.of(context).colorScheme.surfaceVariant,
                  borderRadius: M3Shape.medium.borderRadius,
                ),
                child: const Center(
                  child: Text('Chart Placeholder'),
                ),
              ),
            ),
          ],
        ),
      ),
    );
  }

  Widget _buildSidePanel() {
    return Card(
      elevation: M3Elevation.level1,
      child: Padding(
        padding: const EdgeInsets.all(M3Spacing.space24),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            Text(
              'Recent Activity',
              style: M3TypeScale.titleLarge,
            ),
            const SizedBox(height: M3Spacing.space16),
            Expanded(
              child: ListView.separated(
                itemCount: 5,
                separatorBuilder: (context, index) =>
                    const SizedBox(height: M3Spacing.space12),
                itemBuilder: (context, index) {
                  return ListTile(
                    leading: CircleAvatar(
                      backgroundColor: Theme.of(context).colorScheme.primaryContainer,
                      child: Icon(
                        Icons.person,
                        color: Theme.of(context).colorScheme.onPrimaryContainer,
                      ),
                    ),
                    title: Text('User Action ${index + 1}'),
                    subtitle: Text('${5 - index} minutes ago'),
                  );
                },
              ),
            ),
          ],
        ),
      ),
    );
  }
}
```

## üé™ Complete Component Examples

### Enhanced Button Variations

```dart
// Collection of button variations using M3 tokens
class M3ButtonShowcase extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return Column(
      crossAxisAlignment: CrossAxisAlignment.stretch,
      children: [
        // Filled button with custom styling
        FilledButton(
          style: FilledButton.styleFrom(
            minimumSize: Size.fromHeight(M3CompButton.heightMedium),
            padding: M3CompButton.paddingMedium,
            shape: RoundedRectangleBorder(
              borderRadius: M3CompButton.shapeMedium,
            ),
            elevation: M3CompButton.elevationDefault,
          ),
          onPressed: () {},
          child: const Text('Filled Button'),
        ),
        
        const SizedBox(height: M3Spacing.space16),
        
        // Outlined button with state layer
        OutlinedButton(
          style: OutlinedButton.styleFrom(
            minimumSize: Size.fromHeight(M3CompButton.heightMedium),
            padding: M3CompButton.paddingMedium,
            shape: RoundedRectangleBorder(
              borderRadius: M3CompButton.shapeMedium,
            ),
            side: BorderSide(
              width: M3Border.thin,
              color: Theme.of(context).colorScheme.outline,
            ),
          ),
          onPressed: () {},
          child: const Text('Outlined Button'),
        ),
        
        const SizedBox(height: M3Spacing.space16),
        
        // Text button with proper touch target
        TextButton(
          style: TextButton.styleFrom(
            minimumSize: Size.fromHeight(M3CompButton.heightMedium),
            padding: M3CompButton.paddingMedium,
            shape: RoundedRectangleBorder(
              borderRadius: M3CompButton.shapeMedium,
            ),
          ),
          onPressed: () {},
          child: const Text('Text Button'),
        ),
        
        const SizedBox(height: M3Spacing.space16),
        
        // Icon button with proper accessibility
        M3Accessibility.accessibleButton(
          onPressed: () {},
          semanticLabel: 'Add new item',
          tooltip: 'Adds a new item to the list',
          child: Container(
            width: M3IconSize.standard * 2,
            height: M3IconSize.standard * 2,
            decoration: BoxDecoration(
              color: Theme.of(context).colorScheme.primaryContainer,
              borderRadius: M3Shape.small.borderRadius,
            ),
            child: Icon(
              Icons.add,
              size: M3IconSize.standard,
              color: Theme.of(context).colorScheme.onPrimaryContainer,
            ),
          ),
        ),
      ],
    );
  }
}
```

### Enhanced Card Variations

```dart
class M3CardShowcase extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return Column(
      children: [
        // Elevated card with custom elevation
        Card(
          elevation: M3Elevation.level2,
          shape: RoundedRectangleBorder(
            borderRadius: M3Shape.large.borderRadius,
          ),
          clipBehavior: Clip.antiAlias,
          child: Column(
            crossAxisAlignment: CrossAxisAlignment.start,
            children: [
              Container(
                height: 200,
                color: Theme.of(context).colorScheme.primaryContainer,
                child: Center(
                  child: Icon(
                    Icons.image,
                    size: 64,
                    color: Theme.of(context).colorScheme.onPrimaryContainer,
                  ),
                ),
              ),
              Padding(
                padding: const EdgeInsets.all(M3Spacing.space16),
                child: Column(
                  crossAxisAlignment: CrossAxisAlignment.start,
                  children: [
                    Text(
                      'Card Title',
                      style: M3TypeScale.titleLarge,
                    ),
                    const SizedBox(height: M3Spacing.space8),
                    Text(
                      'Card description with additional details about the content.',
                      style: M3TypeScale.bodyMedium,
                    ),
                    const SizedBox(height: M3Spacing.space16),
                    Row(
                      mainAxisAlignment: MainAxisAlignment.end,
                      children: [
                        TextButton(
                          onPressed: () {},
                          child: const Text('Action 1'),
                        ),
                        const SizedBox(width: M3Spacing.space8),
                        FilledButton(
                          onPressed: () {},
                          child: const Text('Action 2'),
                        ),
                      ],
                    ),
                  ],
                ),
              ),
            ],
          ),
        ),
        
        const SizedBox(height: M3Spacing.space24),
        
        // Outlined card
        Card(
          elevation: 0,
          shape: RoundedRectangleBorder(
            borderRadius: M3Shape.medium.borderRadius,
            side: BorderSide(
              color: Theme.of(context).colorScheme.outline,
              width: M3Border.thin,
            ),
          ),
          child: Padding(
            padding: const EdgeInsets.all(M3Spacing.space16),
            child: Column(
              crossAxisAlignment: CrossAxisAlignment.start,
              children: [
                Text(
                  'Outlined Card',
                  style: M3TypeScale.titleMedium,
                ),
                const SizedBox(height: M3Spacing.space8),
                Text(
                  'This card uses an outline instead of elevation.',
                  style: M3TypeScale.bodyMedium,
                ),
              ],
            ),
          ),
        ),
      ],
    );
  }
}
```

## üöÄ Performance Considerations

### Optimizing Animations

```dart
// Use SingleTickerProviderStateMixin for single animations
class OptimizedAnimatedWidget extends StatefulWidget {
  @override
  _OptimizedAnimatedWidgetState createState() => _OptimizedAnimatedWidgetState();
}

class _OptimizedAnimatedWidgetState extends State<OptimizedAnimatedWidget>
    with SingleTickerProviderStateMixin {
  late AnimationController _controller;

  @override
  void initState() {
    super.initState();
    _controller = AnimationController(
      duration: M3MotionDuration.medium2,
      vsync: this,
    );
  }

  @override
  void dispose() {
    _controller.dispose();
    super.dispose();
  }

  @override
  Widget build(BuildContext context) {
    // Use AnimatedBuilder to minimize rebuilds
    return AnimatedBuilder(
      animation: _controller,
      builder: (context, child) {
        return Transform.scale(
          scale: 1.0 + (_controller.value * 0.1),
          child: child,
        );
      },
      child: const Card(
        child: Padding(
          padding: EdgeInsets.all(M3Spacing.space16),
          child: Text('Optimized Animation'),
        ),
      ),
    );
  }
}

// Use TweenAnimationBuilder for simple animations
Widget optimizedTweenAnimation({required bool isExpanded}) {
  return TweenAnimationBuilder<double>(
    duration: M3MotionDuration.short4,
    curve: M3MotionEasing.standardDecelerate,
    tween: Tween(begin: 0, end: isExpanded ? 1 : 0),
    builder: (context, value, child) {
      return Container(
        height: 50 + (150 * value),
        decoration: BoxDecoration(
          color: Theme.of(context).colorScheme.surfaceVariant,
          borderRadius: BorderRadius.circular(
            M3Radius.medium + (M3Radius.large - M3Radius.medium) * value,
          ),
        ),
        child: child,
      );
    },
    child: const Center(child: Text('Expanding Container')),
  );
}
```

### Memory-Efficient Responsive Design

```dart
// Cache responsive values to avoid repeated calculations
class ResponsiveCache {
  static final Map<String, dynamic> _cache = {};

  static T getResponsiveValue<T>(
    BuildContext context,
    String key,
    T Function() calculator,
  ) {
    final mediaQuery = MediaQuery.of(context);
    final cacheKey = '${key}_${mediaQuery.size.width}_${mediaQuery.size.height}';
    
    if (!_cache.containsKey(cacheKey)) {
      _cache[cacheKey] = calculator();
    }
    
    return _cache[cacheKey] as T;
  }

  static void clear() => _cache.clear();
}

// Usage example
class EfficientResponsiveWidget extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    final columns = ResponsiveCache.getResponsiveValue<int>(
      context,
      'grid_columns',
      () => M3Adaptive.responsiveValue<int>(
        context: context,
        compact: 1,
        medium: 2,
        expanded: 3,
      ),
    );

    return GridView.builder(
      gridDelegate: SliverGridDelegateWithFixedCrossAxisCount(
        crossAxisCount: columns,
        crossAxisSpacing: M3Spacing.space16,
        mainAxisSpacing: M3Spacing.space16,
      ),
      itemBuilder: (context, index) => Card(
        child: Center(child: Text('Item $index')),
      ),
    );
  }
}
```

## üîß Migration Guide

### From Flutter Material 2 to Material Design 3

```dart
// Before (Material 2)
ThemeData(
  primarySwatch: Colors.blue,
  accentColor: Colors.blueAccent,
  brightness: Brightness.light,
)

// After (Material 3)
M3Theme.light(
  seedColor: Colors.blue,
).toThemeData()

// Or using Flutter's built-in M3 support
ThemeData(
  colorScheme: ColorScheme.fromSeed(seedColor: Colors.blue),
  useMaterial3: true,
)
```

### From Basic Tokens to Advanced Features

```dart
// Basic token usage
Container(
  padding: const EdgeInsets.all(16),
  decoration: BoxDecoration(
    color: Colors.white,
    borderRadius: BorderRadius.circular(8),
    boxShadow: [
      BoxShadow(
        color: Colors.black.withOpacity(0.1),
        blurRadius: 4,
        offset: const Offset(0, 2),
      ),
    ],
  ),
)

// Advanced M3 token usage
Container(
  padding: const EdgeInsets.all(M3Spacing.space16),
  decoration: ShapeDecoration(
    shape: M3Shape.medium,
    color: M3TonalColor.fromElevation(context, M3Elevation.level2),
    shadows: M3Shadow.fromElevation(M3Elevation.level2),
  ),
)
```

## üéâ More Examples

For more comprehensive examples and interactive demos, visit:

[https://flutterweb-wasm.web.app/](https://flutterweb-wasm.web.app/)

### Live Examples Include:

- **Complete Component Library**: All M3 components with proper token usage
- **Responsive Dashboard**: Multi-pane adaptive layouts
- **Accessibility Playground**: WCAG-compliant component demonstrations
- **Animation Patterns**: Context-aware motion examples
- **Theme Customization**: Dynamic color scheme generation
- **Performance Benchmarks**: Optimized implementations

### Getting Started Checklist

1. ‚úÖ **Install the package** and import Material Design 3
2. ‚úÖ **Set up basic theming** using `M3Theme.light()` and `M3Theme.dark()`
3. ‚úÖ **Implement responsive layout** with `M3AdaptiveScaffold`
4. ‚úÖ **Apply accessibility features** using `M3Accessibility` utilities
5. ‚úÖ **Use proper token hierarchy** following ref/sys/comp structure
6. ‚úÖ **Add motion patterns** with `M3MotionUtils` for polished interactions
7. ‚úÖ **Test across devices** to ensure adaptive design works properly
8. ‚úÖ **Validate accessibility** using screen readers and contrast checkers

---

This Material Design 3 library provides everything you need to build beautiful, accessible, and responsive Flutter applications that fully comply with Google's Material Design 3 guidelines. The comprehensive token system, advanced utilities, and adaptive components make it easy to create professional apps that work across all platforms and devices.
